---
layout: post
title: "Querying the ZDB with lobid-resources"
date: 2018-08-30
author: Adrian Pohl
tags: lobid-resources
---

We have heard that there is some interest in using lobid as interface to the data of the *Zeitschriftendatenbank* (ZDB), the Union Catalogue of Serials. [ZDB](http://www.zeitschriftendatenbank.de) is the central bibliographic and holdings database for periodicals in Germany and Austria. It records holdings of nearly all German academic libraries and of many public libraries. Responsible for the technical aspects are the Berlin State Library and the German National Library (DNB). ZDB data as [licensed under CC0](http://www.zeitschriftendatenbank.de/ueber-uns/datenlizenz/).

 As libraries in North Rhine-Westphalia also make heavy use of ZDB it is part of the North Rhine-Westphalian Library Service Centre's (hbz) union catalogue. Although a [new search ZDB interface](https://zdb-katalog.de) for ZDB was recently launched, it does not offer a web API for access and use by developers.

This is where lobid comes into play. [lobid-resources](https://lobid.org/resources) provides a user interface and web API based on JSON-LD via HTPP for the hbz union catalgue. The (hbz) union catalogue records approximately 20 Million bibliographic tiles plus holding information. It contains cooperatively created title and holdings information from libraries in North Rhine-Westphalia and Rhineland-Palatinate. Besides that, the [North Rhine-Westphalian Bibliography (NWBib)](https://nwbib.de) and all periodicals from the German Union Catalogue of Serials (ZDB) are included.

**Note**: Although lobid-resources contains all title records from ZDB it does only contain the holdings information for hbz libraries, thus missing the holdings for libraries in other German federal states and Austria.

# The lobid ZDB data

As said, the ZDB data is a subset of lobid-resources which is generated from a MAB/XML export of the hbz union catalogue which is currently maintained with an Aleph system. For some background reading see [this post](http://blog.lobid.org/2017/06/08/lobid-api-why-how.html) about lobid APIs and the JSON-LD behind it and [this post](http://blog.lobid.org/2017/04/19/vocabulary-choices.html) about the vocabularies we chose for representing the bibliographic data in RDF. The [lobid-resources API documentation](http://lobid.org/resources/api) contains more details but is currently only available in German. We will try to change this soon.

There also exist RDF representations of ZDB titles offered directly by the ZDB, see e.g. the journal ["Erkenntnis" at the ZDB (Turtle)](http://ld.zdb-services.de/data/203461-x.ttl) and [in lobid](http://lobid.org/resources/HT001320263.json). Those entries differ in different aspects:

- *identifiers*: URIs in lobid are built off the hbz ID from the Aleph system while ZDB uses its specific IDs, look for example at the predecessor/sucessor resp. rdau:P60261/rdau:P60278 triples. Lobid attaches the ZDB ID to each resource, though, with the key `zdbId`.
- *modeling approaches*: Alhough both ZDB and hbz/lobid learn from each other and often use the same approach and properties for expressing some information, they sometimes differ e.g. for representing publication date, place and publisher.
- *information covered*: You can find some information in lobid that you won't find in the ZDB RDF (e.g. record creation/modification information, and the hbz holdings) and the other way round (e.g. RDA content, media, carrier).

However, we are happy to adjust, improve and add information as needed. Just let us know.

# Accessing ZDB via lobid

## Selecting the ZDB subset

Every ZDB entry in lobid is marked as part of ZDB like so:

```json
{
  "inCollection":[
    {
      "id":"http://lobid.org/resources/HT014846970#!",
      "label":"Zeitschriftendatenbank (ZDB)",
      "type":[
        "Collection"
      ]
    }
  ]
}
```

Using the [Elasticsearch Query String Syntax](https://www.elastic.co/guide/en/elasticsearch/reference/5.6/query-dsl-query-string-query.html#query-string-syntax) (see also our [post on building complex queries](http://blog.lobid.org/2018/07/06/lobid-gnd-queries.html), also in German) you can limit your queries to lobid-resources on ZDB resources like so:

[`inCollection.id:"http://lobid.org/resources/HT014846970#!"`](http://lobid.org/resources/search?q=inCollection.id%3A%22http%3A%2F%2Flobid.org%2Fresources%2FHT014846970%23%21%22)

## Querying the subset

As you can see, ZDB compries around 1.9 Million entries. You can now add to this query as you like to get your desired results from ZDB data. Some examples:

- Using an `_exists_` query to get all ZDB resources that have an ISSN: [`inCollection.id:"http://lobid.org/resources/HT014846970#!" AND _exists_:issn`](http://lobid.org/resources/search?q=inCollection.id%3A%22http%3A%2F%2Flobid.org%2Fresources%2FHT014846970%23%21%22+AND+_exists_%3Aissn)
-

## Bulk downloads and post processing

You use the APIs [bulk options](http://lobid.org/resources/api#content_types) to download all the ZDB data or some subsets to be able to run some scripts on them locally.

For example, download all ZDB resources with an ISSN and create a list of all ISSNs in ZDB by using [jq](https://stedolan.github.io/jq/):

`$ curl -H "Accept: application/x-jsonlines" 'http://lobid.org/resources/search?q=inCollection.id%3A%22http%3A%2F%2Flobid.org%2Fresources%2FHT014846970%23%21%22+AND+_exists_%3Aissn' | jq -r .issn[] > zdb-issn.txt`

(This will take some time, just took me nearly two minutes, you may speed it up by downloading gzipped data with `Accept-Encoding: gzip`.)